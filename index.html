<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>月記帳｜薪資扣除試算 & 記錄（含 114 級距自動帶入）</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      --bg: linear-gradient(135deg,#eaf6ff,#f6f9ff);
      --card: rgba(255,255,255,.8);
      --text:#1f2937;
      --muted:#6b7280;
      --brand:#4f46e5;
      --ok:#10b981;
      --warn:#f59e0b;
      --danger:#ef4444;
      --ring: rgba(79,70,229,.25);
    }
    .dark{
      --bg: radial-gradient(1200px 800px at 10% 10%, #1f2937, #0b1020);
      --card: rgba(17,24,39,.75);
      --text:#e5e7eb;
      --muted:#9ca3af;
      --brand:#8b5cf6;
      --ok:#34d399;
      --warn:#fbbf24;
      --danger:#f87171;
      --ring: rgba(139,92,246,.25);
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100dvh;display:flex;flex-direction:column;gap:16px;
      font-family:"Noto Sans TC",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; 
      background:var(--bg); color:var(--text);
    }
    header{ position:sticky;top:0;z-index:5; backdrop-filter:saturate(150%) blur(10px); background:transparent; padding:16px 12px 0; }
    .wrap{max-width:980px;margin:0 auto;padding:12px;}
    .title{ display:flex;align-items:center;gap:12px;flex-wrap:wrap; }
    .title h1{font-size:22px;margin:0;font-weight:700;letter-spacing:.5px}
    .badge{font-size:12px;padding:4px 10px;border-radius:999px;background:var(--card);box-shadow:0 6px 24px rgba(0,0,0,.07);border:1px solid rgba(0,0,0,.05)}

    .card{ background:var(--card);border:1px solid rgba(255,255,255,.35); border-radius:18px;box-shadow:0 12px 40px rgba(0,0,0,.12); backdrop-filter: blur(12px) saturate(160%); padding:16px;margin:8px 0;position:relative;overflow:hidden; }
    .row{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:720px){.row{grid-template-columns:1.25fr .75fr}}

    .field{display:flex;flex-direction:column;gap:6px}
    label{font-size:13px;color:var(--muted)}
    input,select{height:42px;padding:0 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:rgba(255,255,255,.7);outline:none;color:inherit}
    .dark input,.dark select{background:rgba(0,0,0,.25);border-color:rgba(255,255,255,.08)}
    input:focus,select:focus{box-shadow:0 0 0 6px var(--ring);border-color:transparent}

    .switch{display:inline-flex;align-items:center;gap:10px}
    .switch input{width:auto;height:auto}

    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
    .round-btn{ display:inline-flex;align-items:center;justify-content:center;gap:8px; height:46px;padding:0 18px;border-radius:999px;border:0;cursor:pointer; background:linear-gradient(135deg,var(--brand),#22c1c3); color:white;font-weight:600; box-shadow:0 10px 24px rgba(79,70,229,.35); transform:translateY(0); transition:.2s transform cubic-bezier(.2,.8,.2,1), filter .2s; }
    .round-btn:hover{transform:translateY(-2px)}
    .round-btn:active{transform:translateY(0)}
    .ghost{background:transparent;color:var(--brand);border:1.5px dashed var(--brand)}
    .danger{background:linear-gradient(135deg,var(--danger),#ef5da8); box-shadow:0 10px 24px rgba(239,68,68,.35)}

    .totals{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .pill{ background:rgba(255,255,255,.6);border:1px solid rgba(0,0,0,.05); border-radius:14px;padding:10px 12px;display:flex;justify-content:space-between;align-items:center;font-weight:600 }
    .dark .pill{background:rgba(0,0,0,.3);border-color:rgba(255,255,255,.08)}

    .list{display:flex;flex-direction:column;gap:12px;margin-top:8px}
    .item{ background:rgba(255,255,255,.75);border:1px solid rgba(0,0,0,.06); border-radius:16px;padding:12px 14px;position:relative;overflow:hidden; box-shadow:0 10px 24px rgba(0,0,0,.09); touch-action: pan-y; }
    .dark .item{background:rgba(0,0,0,.25);border-color:rgba(255,255,255,.08)}
    .item h4{margin:0 0 6px 0;font-size:15px}
    .meta{color:var(--muted);font-size:12px;display:flex;flex-wrap:wrap;gap:10px}
    .sum{margin-top:6px;font-weight:700}
    .swipeDel{ position:absolute;inset:0;display:flex;align-items:center;justify-content:flex-end; padding-right:14px;pointer-events:none;opacity:.0;transition:opacity .15s; background:linear-gradient(90deg,transparent, rgba(239,68,68,.06)); }
    .swipeDel .btnDel{pointer-events:auto}
    .btnDel{border:0;background:var(--danger);color:#fff;border-radius:12px;padding:8px 12px;font-weight:700}

    .footerNote{color:var(--muted);font-size:12px;margin-top:8px}
    .chip{padding:2px 8px;border-radius:999px;border:1px solid rgba(0,0,0,.08);background:rgba(255,255,255,.65)}
    .dark .chip{background:rgba(0,0,0,.25);border-color:rgba(255,255,255,.08)}
    .hr{height:1px;background:linear-gradient(90deg,transparent,rgba(0,0,0,.12),transparent);margin:8px 0}
    .flex{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  </style>
</head>
<body>
  <header>
    <div class="wrap title">
      <h1>月記帳｜薪資扣除試算 & 記錄</h1>
      <span class="badge">114(2025) 級距自動帶入・圓形按鈕・暗色模式</span>
      <div class="flex" style="margin-left:auto">
        <button id="toggleDark" class="round-btn ghost" title="暗色模式">🌙 暗色</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="row">
        <div>
          <div class="field">
            <label>月份</label>
            <input id="month" type="month" />
          </div>
          <div class="field">
            <label>本月薪資（含加班津貼）</label>
            <input id="salary" type="number" inputmode="decimal" placeholder="例如 42000" />
          </div>

          <div class="field">
            <label class="flex"><span>依 114(2025) 級距自動帶入（員工負擔：勞保＋健保）</span> <span class="chip">以薪資就近「較低級距」</span></label>
            <div class="flex">
              <label class="switch"><input id="chkAutoGrade" type="checkbox"> 開啟</label>
              <select id="gradeSelect" disabled style="width:160px"></select>
              <span id="gradeInfo" class="chip">未啟用</span>
            </div>
          </div>

          <div class="hr"></div>

          <div class="field">
            <label class="flex"><span>勞退自提（預設 6%）</span> <span class="chip">依照 <b>薪資 × %</b> 試算</span></label>
            <div class="flex">
              <label class="switch"><input id="chkPension" type="checkbox" checked> 開啟</label>
              <input id="pensionRate" type="number" value="6" min="0" step="0.1" style="width:120px"/> <span>%</span>
              <span id="pensionAmtView" class="chip">金額：0</span>
            </div>
          </div>

          <div class="field">
            <label class="flex"><span>勞保（級距或金額）</span> <span class="chip">可擇一：<b>金額直填</b> 或 <b>級距 × 員工負擔率%</b></span></label>
            <div class="flex">
              <input id="lbAmount" type="number" placeholder="直接輸入金額（元）" style="width:220px" />
              <span>或</span>
              <input id="lbInsured" list="insuredList" type="number" placeholder="投保薪資（級距）" style="width:180px" />
              <input id="lbRate" type="number" placeholder="員工負擔率 %" style="width:150px" step="0.01" />
              <span id="lbAmtView" class="chip">金額：0</span>
            </div>
          </div>

          <div class="field">
            <label class="flex"><span>健保（級距或金額）</span> <span class="chip">可擇一：<b>金額直填</b> 或 <b>級距 × 被保險人自付率%</b></span></label>
            <div class="flex">
              <input id="nhAmount" type="number" placeholder="直接輸入金額（元）" style="width:220px" />
              <span>或</span>
              <input id="nhInsured" list="insuredList" type="number" placeholder="投保薪資（級距）" style="width:180px" />
              <input id="nhRate" type="number" placeholder="被保險人自付率 %" style="width:150px" step="0.01" />
              <span id="nhAmtView" class="chip">金額：0</span>
            </div>
          </div>

          <datalist id="insuredList">
            <option value="28590"></option>
            <option value="28800"></option>
            <option value="30300"></option>
            <option value="31800"></option>
            <option value="33300"></option>
            <option value="34800"></option>
            <option value="36300"></option>
            <option value="38200"></option>
            <option value="40100"></option>
            <option value="42000"></option>
            <option value="43900"></option>
            <option value="45800"></option>
            <option value="48200"></option>
            <option value="50600"></option>
            <option value="53000"></option>
            <option value="55400"></option>
            <option value="57800"></option>
            <option value="60800"></option>
            <option value="63800"></option>
            <option value="66800"></option>
            <option value="69800"></option>
            <option value="72800"></option>
            <option value="76500"></option>
          </datalist>

          <div class="field">
            <label class="flex"><span>福利金（預設 0.5%）</span> <span class="chip">依照 <b>薪資 × %</b> 試算（公司規定）</span></label>
            <div class="flex">
              <label class="switch"><input id="chkWelfare" type="checkbox"> 開啟</label>
              <input id="welfareRate" type="number" value="0.5" min="0" step="0.1" style="width:120px"/> <span>%</span>
              <span id="welfareAmtView" class="chip">金額：0</span>
            </div>
          </div>

          <div class="btns">
            <button id="btnAdd" class="round-btn">➕ 新增／更新本月紀錄</button>
            <button id="btnExport" class="round-btn">⬇️ 匯出 JSON</button>
            <label class="round-btn" for="fileImport" style="cursor:pointer">⬆️ 匯入 JSON<input id="fileImport" type="file" accept="application/json" style="display:none"></label>
            <button id="btnClearAll" class="round-btn danger">🗑️ 清空全部紀錄</button>
          </div>
        </div>

        <div>
          <div class="field">
            <label>即時計算</label>
            <div class="totals">
              <div class="pill">扣除合計 <span id="deductTotal">0</span></div>
              <div class="pill">實領<span id="netPay">0</span></div>
            </div>
            <canvas id="pie" height="220" style="margin-top:8px"></canvas>
            <div class="footerNote">提示：表格採用 114(2025) 年度常見級距與負擔金額（員工端）。仍請以公司實際投保與單位通知為準。</div>
          </div>

          <div class="card" style="margin-top:12px">
            <div class="field">
              <label>反推薪資（已知「扣款金額」與「%」）</label>
              <div class="flex">
                <input id="revAmt" type="number" placeholder="例如：2178" style="width:160px">
                <input id="revPct" type="number" placeholder="例如：6" style="width:120px"> <span>%</span>
                <button id="btnReverse" class="round-btn">↩︎ 反推</button>
              </div>
              <div class="pill" style="margin-top:8px">推算薪資 <span id="revBase">0</span></div>
              <div class="footerNote">例：自提 <b>6% = 2178</b> → 薪資 = 2178 ÷ 6% = <b>36,300</b>；若薪資 <b>38,200</b>，6% = <b>2,292</b>。</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="flex" style="justify-content:space-between;align-items:center">
        <h3 style="margin:0">我的每月紀錄</h3>
        <span class="chip">左右滑動可刪除或編輯</span>
      </div>
      <div id="list" class="list"></div>
    </section>
  </main>

  <script>
    // ===== Dark mode =====
    const darkBtn = document.getElementById('toggleDark');
    const LS_DARK = 'paybook:dark';
    function applyDark(d){ document.documentElement.classList.toggle('dark', d); }
    applyDark(localStorage.getItem(LS_DARK)==='1');
    darkBtn.onclick = ()=>{ const d = !document.documentElement.classList.contains('dark'); localStorage.setItem(LS_DARK, d?'1':'0'); applyDark(d); }

    // ===== DOM refs =====
    const $ = s=>document.querySelector(s);
    const month = $('#month');
    const salary = $('#salary');

    const chkAutoGrade = $('#chkAutoGrade');
    const gradeSelect = $('#gradeSelect');
    const gradeInfo = $('#gradeInfo');

    const chkPension = $('#chkPension');
    const pensionRate = $('#pensionRate');
    const pensionAmtView = $('#pensionAmtView');

    const lbAmount = $('#lbAmount');
    const lbInsured = $('#lbInsured');
    const lbRate = $('#lbRate');
    const lbAmtView = $('#lbAmtView');

    const nhAmount = $('#nhAmount');
    const nhInsured = $('#nhInsured');
    const nhRate = $('#nhRate');
    const nhAmtView = $('#nhAmtView');

    const chkWelfare = $('#chkWelfare');
    const welfareRate = $('#welfareRate');
    const welfareAmtView = $('#welfareAmtView');

    const deductTotal = $('#deductTotal');
    const netPay = $('#netPay');

    const btnAdd = $('#btnAdd');
    const btnExport = $('#btnExport');
    const fileImport = $('#fileImport');
    const btnClearAll = $('#btnClearAll');

    const list = $('#list');

    const revAmt = $('#revAmt');
    const revPct = $('#revPct');
    const btnReverse = $('#btnReverse');
    const revBase = $('#revBase');

    const LS_KEY = 'paybook:records';

    // ===== Utils =====
    const fmt = n => Number(n||0).toLocaleString('zh-TW', {maximumFractionDigits:0});
    const toNum = v => v===''||v==null?0:Number(v);
    const clamp = (n,min=0)=> isFinite(n)? Math.max(n,min):0;

    // ===== 114(2025) 級距表（員工負擔：勞保/健保/合計） =====
    const GRADES = [
      {g:28590, lb:715,  nh:443,  t:1158},
      {g:28800, lb:720,  nh:447,  t:1167},
      {g:30300, lb:758,  nh:470,  t:1228},
      {g:31800, lb:795,  nh:493,  t:1288},
      {g:33300, lb:833,  nh:516,  t:1349},
      {g:34800, lb:870,  nh:540,  t:1410},
      {g:36300, lb:908,  nh:563,  t:1471},
      {g:38200, lb:955,  nh:592,  t:1547},
      {g:40100, lb:1002, nh:622,  t:1624},
      {g:42000, lb:1060, nh:651,  t:1711},
      {g:43900, lb:1098, nh:681,  t:1779},
      {g:45800, lb:1145, nh:710,  t:1855},
      {g:48200, lb:1145, nh:748,  t:1893},
      {g:50600, lb:1145, nh:785,  t:1930},
      {g:53000, lb:1145, nh:822,  t:1967},
      {g:55400, lb:1145, nh:859,  t:2004},
      {g:57800, lb:1145, nh:896,  t:2041},
      {g:60800, lb:1145, nh:943,  t:2088},
      {g:63800, lb:1145, nh:990,  t:2135},
      {g:66800, lb:1145, nh:1036, t:2181},
      {g:69800, lb:1145, nh:1083, t:2228},
      {g:72800, lb:1145, nh:1129, t:2274},
      {g:76500, lb:1145, nh:1187, t:2332},
    ];

    // 建立下拉級距
    function buildGradeOptions(){
      gradeSelect.innerHTML = '';
      for(const r of GRADES){
        const opt = document.createElement('option');
        opt.value = r.g;
        opt.textContent = `${r.g.toLocaleString()}（勞保 ${r.lb.toLocaleString()}／健保 ${r.nh.toLocaleString()}／合計 ${r.t.toLocaleString()}）`;
        gradeSelect.appendChild(opt);
      }
    }

    // 依薪資選擇級距（就近較低）
    function pickGradeBySalary(base){
      let best = GRADES[0];
      for(const r of GRADES){ if(base >= r.g) best = r; else break; }
      return best;
    }

    // 當前是否啟用自動級距
    function applyAutoGrade(){
      const enabled = chkAutoGrade.checked;
      gradeSelect.disabled = !enabled;
      if(!enabled){ gradeInfo.textContent = '未啟用'; return; }

      const base = clamp(toNum(salary.value));
      // 以薪資挑級距（若下拉已選，優先用下拉）
      let row = GRADES.find(r=>r.g===toNum(gradeSelect.value));
      if(!row){ row = pickGradeBySalary(base); gradeSelect.value = String(row.g); }

      // 將員工端金額帶入「金額直填」
      lbAmount.value = row.lb; lbInsured.value = ''; lbRate.value = '';
      nhAmount.value = row.nh; nhInsured.value = ''; nhRate.value = '';

      gradeInfo.textContent = `級距 ${row.g.toLocaleString()}，員工合計 ${row.t.toLocaleString()} 元`;
    }

    // ===== Chart =====
    let pie; const ctx = document.getElementById('pie');
    function upChart(parts){
      const labels = parts.filter(p=>p.v>0).map(p=>p.k);
      const data = parts.filter(p=>p.v>0).map(p=>p.v);
      if(!pie){
        pie = new Chart(ctx,{ type:'doughnut', data:{labels,datasets:[{data}]}, options:{plugins:{legend:{position:'bottom'}},cutout:'60%'} });
      }else{ pie.data.labels = labels; pie.data.datasets[0].data = data; pie.update(); }
    }

    // ===== Live calc =====
    function calc(){
      const base = clamp(toNum(salary.value));

      // 若啟用自動級距，先帶入金額
      if(chkAutoGrade.checked){ applyAutoGrade(); }

      // 勞退
      const pAmt = chkPension.checked? Math.round(base * clamp(toNum(pensionRate.value))/100) : 0;
      pensionAmtView.textContent = '金額：' + fmt(pAmt);

      // 勞保：金額直填優先，否則用級距*率
      let lbAmt = clamp(toNum(lbAmount.value));
      if(lbAmt===0){ const ins = clamp(toNum(lbInsured.value)); const r = clamp(toNum(lbRate.value)); lbAmt = Math.round(ins * r / 100); }
      lbAmtView.textContent = '金額：' + fmt(lbAmt);

      // 健保
      let nhAmt = clamp(toNum(nhAmount.value));
      if(nhAmt===0){ const ins = clamp(toNum(nhInsured.value)); const r = clamp(toNum(nhRate.value)); nhAmt = Math.round(ins * r / 100); }
      nhAmtView.textContent = '金額：' + fmt(nhAmt);

      // 福利金
      const wfAmt = chkWelfare.checked? Math.round(base * clamp(toNum(welfareRate.value))/100) : 0;
      welfareAmtView.textContent = '金額：' + fmt(wfAmt);

      const totalDeduct = pAmt + lbAmt + nhAmt + wfAmt;
      const net = Math.max(0, base - totalDeduct);
      deductTotal.textContent = fmt(totalDeduct);
      netPay.textContent = fmt(net);

      upChart([
        {k:'自提6%', v:pAmt},
        {k:'勞保', v:lbAmt},
        {k:'健保', v:nhAmt},
        {k:'福利金', v:wfAmt},
      ]);
      return { base, pAmt, lbAmt, nhAmt, wfAmt, totalDeduct, net };
    }

    // Live events
    ['input','change','keyup'].forEach(evt=>{
      [salary, chkAutoGrade, gradeSelect, chkPension, pensionRate, lbAmount, lbInsured, lbRate, nhAmount, nhInsured, nhRate, chkWelfare, welfareRate]
        .forEach(el=>el.addEventListener(evt, calc));
    });

    // ===== Reverse =====
    btnReverse.addEventListener('click',()=>{
      const amt = clamp(toNum(revAmt.value));
      const pct = clamp(toNum(revPct.value));
      if(amt>0 && pct>0){ const base = Math.round( amt / (pct/100) ); revBase.textContent = fmt(base); }
    });

    // ===== Records =====
    function load(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||'[]'); }catch(e){ return [] } }
    function save(arr){ localStorage.setItem(LS_KEY, JSON.stringify(arr)); }

    function render(){
      const arr = load().sort((a,b)=> (a.month||'').localeCompare(b.month||''));
      list.innerHTML = '';
      if(arr.length===0){ list.innerHTML = '<div class="footerNote">尚無紀錄，填寫左側資料後按「新增／更新本月紀錄」。</div>'; return; }
      for(const rec of arr){
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <div class="swipeDel"><button class="btnDel">刪除</button></div>
          <h4>${rec.month}｜實領 ${fmt(rec.net)} 元</h4>
          <div class="meta">
            <span>薪資 ${fmt(rec.base)}</span>
            <span>勞退自提 ${fmt(rec.pAmt)}</span>
            <span>勞保 ${fmt(rec.lbAmt)}</span>
            <span>健保 ${fmt(rec.nhAmt)}</span>
            <span>福利金 ${fmt(rec.wfAmt)}</span>
          </div>
          <div class="sum">扣除合計：${fmt(rec.totalDeduct)} 元</div>
        `;

        // swipe to delete / tap to edit
        let sx=0, dx=0; const del = div.querySelector('.swipeDel');
        const btnDel = div.querySelector('.btnDel');
        btnDel.addEventListener('click', ()=>{
          const ok = confirm(`刪除 ${rec.month} 紀錄？`);
          if(!ok) return;
          const all = load().filter(x=>x.month!==rec.month);
          save(all); render();
        });

        div.addEventListener('touchstart', e=>{ sx = e.changedTouches[0].clientX; });
        div.addEventListener('touchmove', e=>{ dx = e.changedTouches[0].clientX - sx; del.style.opacity = Math.min(1, Math.max(0, (-dx)/80)); });
        div.addEventListener('touchend', e=>{ if(dx < -80){ del.style.opacity=1; } else { del.style.opacity=0; } sx=dx=0; });

        // click to load for edit
        div.addEventListener('click', e=>{
          if(e.target.classList.contains('btnDel')) return;
          month.value = rec.month; salary.value = rec.base;
          chkPension.checked = rec.pAmt>0; pensionRate.value = rec.pRate;
          // 金額直填回填，其他清空供重算
          lbAmount.value = rec.lbAmt; lbInsured.value = ''; lbRate.value = '';
          nhAmount.value = rec.nhAmt; nhInsured.value = ''; nhRate.value = '';
          chkWelfare.checked = rec.wfAmt>0; welfareRate.value = rec.wfRate;
          calc();
          window.scrollTo({top:0, behavior:'smooth'});
        });
        list.appendChild(div);
      }
    }

    function addOrUpdate(){
      const m = month.value || new Date().toISOString().slice(0,7);
      const c = calc();
      const rec = {
        month:m, base:c.base,
        pRate: chkPension.checked? clamp(toNum(pensionRate.value)) : 0,
        pAmt: c.pAmt,
        lbAmt: c.lbAmt,
        nhAmt: c.nhAmt,
        wfRate: chkWelfare.checked? clamp(toNum(welfareRate.value)) : 0,
        wfAmt: c.wfAmt,
        totalDeduct: c.totalDeduct,
        net: c.net
      };
      const arr = load();
      const i = arr.findIndex(x=>x.month===m);
      if(i>=0) arr[i]=rec; else arr.push(rec);
      save(arr); render();
    }

    btnAdd.addEventListener('click', addOrUpdate);

    btnExport.addEventListener('click', ()=>{
      const data = JSON.stringify(load(), null, 2);
      const blob = new Blob([data], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'paybook-records.json';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    fileImport.addEventListener('change', e=>{
      const f = e.target.files?.[0]; if(!f) return;
      const rd = new FileReader();
      rd.onload = () => {
        try{ const arr = JSON.parse(rd.result); if(Array.isArray(arr)){ save(arr); render(); alert('匯入完成'); } }
        catch(err){ alert('匯入失敗：檔案格式錯誤'); }
      };
      rd.readAsText(f);
    });

    btnClearAll.addEventListener('click', ()=>{
      if(confirm('確定要清空全部紀錄？此動作無法復原。')){ save([]); render(); }
    });

    // init
    month.value = new Date().toISOString().slice(0,7);
    buildGradeOptions();
    calc();
    render();
  </script>
</body>
</html>
